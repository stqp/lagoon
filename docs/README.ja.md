# Lagoon



![](./lagoon-logo.png)



## Lagoon - Kubernetes用オープンソースアプリケーションデリバリープラットフォーム



Lagoonは開発者が夢見るものを提供します。それは、開発者が自分のローカル環境と本番環境で全く同じコードを実行できるシステムです。同じDockerイメージ、同じサービス設定、そして同じコード。



## どこから始めればよいですか？



Lagoonを使用してウェブサイトやアプリケーションをホストしたい場合は、[Using Lagoon - The Basics](using-lagoon-the-basics/index.md)にアクセスしてください。



Lagoonの機能をより深く理解したい場合は、[Using Lagoon - Advanced](using-lagoon-advanced/index.md)にアクセスしてください。



Lagoonの仕組みについて理解するには、[Lagoon Concepts - The Basics](concepts-basics/index.md)をチェックしてください。



さらに深い理解を求めるなら、[Lagoon Concepts - Advanced](concepts-advanced/index.md)をご覧ください。



Lagoonの開発に参加したい場合（機能追加やバグ修正など）、[Developing Lagoon](contributing-to-lagoon/developing-lagoon.md)を参照してください。



## TL;DR: Lagoonの動作方法



1. 開発者はYAMLファイル内で必要なサービスを定義・設定します。

2. 満足したら、そのコードをGitにプッシュします。

3. LagoonはYAMLファイルを解析し、追加で必要な設定を加えます。

4. Lagoonは必要なDockerイメージをビルドします。

5. LagoonはそれらをDockerレジストリにプッシュします。

6. LagoonはKubernetes内で必要なリソースを作成します。

7. Lagoonはコンテナのデプロイを監視します。

8. すべてが完了したら、Lagoonは開発者にSlack、メール、ウェブサイトなど様々な方法で通知します。



## ヘルプ?



質問やアイデアがありますか？メンテーナーや貢献者と交流しましょう。



Lagoon Discordでチャットしてください: [https://discord.gg/te5hHe95JE](https://discord.gg/te5hHe95JE)



## Lagoonについてのいくつかのこと



1. **Lagoonはマイクロサービスベースです**。デプロイとビルドのワークフローは非常に複雑です。複数のバージョン管理ソース、複数のクラスター、複数の通知システムが存在します。各デプロイはユニークで、数秒から数時間かかることもあります。柔軟性と堅牢性を念頭に置いて構築されています。マイクロサービスはメッセージングシステムを通じて通信します。これにより、個々のサービスのスケールアップとスケールダウンが可能になります。また、個別のサービスのダウンタイムを乗り切ることができます。さらに、新しいLagoonの部分を本番環境で他の部分に影響を与えずに試すことができます。

2. **Lagoonは多くのプログラミング言語を使用しています**。各プログラミング言語には特定の強みがあります。どの言語が各サービスに最も適しているかを判断しようとしています。現在、Lagoonの多くはNode.jsで構築されています。これはNode.jsを最初に使用し始めたからだけでなく、Node.jsがWebhookやタスクの非同期処理を可能にするからです。サービスの一部のプログラミング言語を変更することも検討しています。これはマイクロサービスの素晴らしいところです！他のプラットフォーム部分に影響を与えることなく、単一のサービスを他の言語に置き換えることができます。

3. **LagoonはDrupal専用ではありません**。すべてのものは任意のDockerイメージを実行できるように構築されています。Drupal用の既存のDockerイメージやDrushのようなDrupal特有のツールのサポートもありますが、それだけです！

4. **LagoonはDevOpsです**。開発者が必要なサービスを定義し、必要に応じてカスタマイズできるようにします。これは正しい方法ではなく、開発者に過剰な権限を与えてしまうと考えるかもしれません。私たちはシステムエンジニアとして、開発者をエンパワーメントする必要があると考えています。もし開発者がローカルでサービスを定義し、テストできるようにすれば、彼ら自身でバグや誤りを見つけることができます。

5. **LagoonはDockerとKubernetes上で動作します**。（これは当然ですよね？）

6. **Lagoonは完全にローカルで開発・テスト可能です**。

7. **Lagoonは完全に統合テストされています**。これは、Git webhookの受信からDockerコンテナへのデプロイまでの全プロセスをテストできることを意味します。同じGitハッシュがクラスター内にデプロイされます。

8. **最も重要なこと: 継続的な作業中であること**。まだ完了していません。amazee.ioでは、ホスティングコミュニティとして協力し、コードを共有することが必要だと考えています。



Lagoonのインフラストラクチャとサービスがどのように連携しているかを理解してほしいと思っています。以下はそのスキーマです（少し古いものですが、最近追加されたサービスやKubernetesについては含まれていませんので、更新に取り組んでいます！）：[Lucid Chart](https://lucid.app/documents/view/cb441054-e04a-4389-b98b-c75bcda8ea0d) ‌



## Lagoonの歴史



前述のように、Lagoonは夢の実現です。amazee.ioでは8年以上Drupalをホスティングしてきました。これは私たちのホスティングプラットフォームの第4世代です。第3世代はPuppetとAnsibleを中心に構築されました。プラットフォームのすべての部分は構成管理によって行われました。これにより、新しいサーバーのセットアップが非常に迅速に行えましたが、同時に開発者にとってのカスタマイズ性が欠けていました。少しはDockerを使用して本番環境でのカスタマイズ性を実現しましたが、完全には満足できませんでした。我々の既存のプラットフォームでは不十分だと感じました。デカップルDrupalの台頭に伴い、サーバーサイドでのNode.jsの実行、Elasticsearchの要求、異なるSolrバージョンなど、より多くのことを行う必要がありました。 ‌



同時に、私たちはローカル開発にDockerを何年も使用してきました。Dockerを本番環境ですべてに使用するというアイデアは常にありました。唯一の問題は、ローカル開発環境と本番環境との間の接続でした。本番環境でDockerを使用してDrupalを実行できるシステムは他にもあります。しかし、同じイメージとサービスをローカルと本番環境でテストできるものはありませんでした。



Lagoonは2017年に誕生しました。それ以来、Dockerを本番環境で実行するシステムへと発展してきました。Lagoonは第3世代のホスティングプラットフォームに代わり、すべてDockerベースの最新システムになりました。



### オープンソース



amazee.ioでは、オープンソースが重要だと信じています。オープンソースコードであるDrupalがプロプライエタリなホスティングプラットフォームでホストされていることには常に悩まされていました。ホスティング会社の強みと成功は、単なるデプロイシステムやサービス設定だけではありません。プラットフォームを運営する人々とその知識によるものです。プロセス、スキル、予期しない状況に対処する能力、そして最後にですが重要なこととして、クライアントに提供するサポートです。



### ライセンス



Lagoonは[`an Apache 2.0 License`](https://github.com/uselagoon/lagoon/blob/main/LICENSE)の下で提供されています。