# 環境アイドリング（オプション）

## 環境アイドラーとは何ですか？

Lagoonは、[Aergiaコントローラー](https://github.com/amazeeio/aergia-controller)（`lagoon-remote`にインストールされています）を利用して、一定期間使用されていない環境を自動的にアイドル状態にします。これは、Kubernetesクラスタの負荷を軽減し、実際に使用中の本番環境と開発環境の全体的なパフォーマンスを向上させるために行われます。

### 環境はどのようにしてアイドル状態になりますか？

環境アイドラーには多くの異なる設定機能があります。ここでは、標準的なLagoonインストールのデフォルトを示します（これらはあなたのLagoonでは全く異なる可能性がありますので、Lagoon管理者に確認してください！）

* アイドリングは4時間ごとに試みられます。
* 本番環境は決してアイドル状態になりません。
* CLIポッドは、cronジョブが含まれておらず、リモートシェル接続がアクティブでない場合にアイドル状態になります。
* 他のすべてのサービスとポッドは、環境上で過去4時間間にトラフィックがなかった場合にアイドル状態になります。
* アクティブなビルドが進行中であれば、アイドリングは行われません。

### 環境はどのようにしてアイドル状態から解除されますか？

Aergiaは、環境が訪問されるとすぐに自動的にアイドル状態を解除します。 したがって、環境の任意のURLを訪れるだけで環境が起動します。同様に、環境へのSSHセッションを開始すると、サービスも再開します。

アンアイドリングは数秒かかります。なぜなら、Kubernetesクラスタはすべてのコンテナを再起動する必要があるからです。この間、訪問者には、現在自分の環境が起動中であることを示す待機画面が表示されます。

### Idlerが私の環境をアイドリングしないように設定することはできますか？

はい、プロジェクト（すべての環境に影響）と環境（1つの環境のみを対象にする必要がある場合）に`autoIdle`フィールドがあり、アイドリングが行われるかどうかを指定できます。`1`の値は、プロジェクト/環境がアイドリングの対象であることを示します。プロジェクトが`0`に設定されている場合、環境が`0`に設定されていても、環境は決してアイドル状態になりません。
デフォルトは常に`1`（アイドリングが有効）です。

これらのプロジェクト/環境フィールドの設定方法がわからない場合は、あなたのLagoon管理者に相談してください。